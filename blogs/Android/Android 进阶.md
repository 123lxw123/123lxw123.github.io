# 启动优化

App 启动分为冷启动、温启动、热启动；冷启动是指 App 进程需要重新开始创建，温启动是指 App 视图已经被回收，但是进程还存活着，热启动是指 App 进程、视图都存活，例如从后台切换至前台。

1. Application 创建回调方法尽量减少耗时操作或者改成异步、延迟操作，例如初始化数据库、SDK 等
2. Launch Activity 创建回调方法尽量减少耗时操作或者改成异步、延迟操作，简化视图复杂度，例如减少布局层次。
3. Launch Activity 设置主题背景，提升用户体验

# App 冷启动流程

1. 加载启动App；
2. App启动之后立即展示出一个空白的Window；
3. 创建App的进程；
4. 创建App对象；
5. 启动Main Thread；
6. 创建启动的Activity对象；
7. 加载View；
8. 布置屏幕；
9. 进行第一次绘制；

# 绘制优化

![image-20190620194028803](/Users/lixiongwen/Library/Application Support/typora-user-images/image-20190620194028803.png)

1. 减少不必要的背景
2. 减少嵌套层次
   - 使用 Merge 标签
   - 优先使用 RelativeLayout 等约束布局
3. 减少控件个数
   - 使用 ViewStub 标签
   - 使用 Spannable / Html.fromHtml() 替换多规格 TextView
   - 使用 LinearLayout 自带的分割线
4. 避免在 onDraw() 方法内创建对象，进行复杂运算
5. 使用低端机进行优化，发现性能瓶颈

# 内存抖动

内存抖动是由于短时间内有大量对象进出新生区导致的，它伴随着频繁的GC，gc会大量占用ui线程和cpu资源，会导致app整体卡顿。

避免发生内存抖动的几点建议：

- 尽量避免在循环体内创建对象，应该把对象创建移到循环体外。
- 注意自定义View的onDraw()方法会被频繁调用，所以在这里面不应该频繁的创建对象。
- 当需要大量使用Bitmap的时候，试着把它们缓存在数组或容器中实现复用。
- 对于能够复用的对象，同理可以使用对象池将它们缓存起来。

# 常见内存优化方法

1. 图片优化
   - 尽量选择内存占用少的色彩模式
   - 图片压缩-分辨率
   - 图片压缩-质量
2. 重写 Application 的 onTrimMemory() 方法释放缓存
3. 适当使用弱引用和软引用
4. 尽量采用静态内部类，静态常量
5. onDraw() 尽量避免创建对象