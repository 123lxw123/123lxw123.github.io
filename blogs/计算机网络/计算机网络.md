#  计算机网络

## HTTP 与 HTTPS

![image-20190604173658214](/Users/lixiongwen/Library/Application Support/typora-user-images/image-20190604173658214.png)

## HTTP 1.x 与HTTP 2

1. 新的二进制格式，1.x 基于文本
2. 多路复用(连接共享)，多个 request 共用一个连接
3. header 压缩，通讯双方各自缓存一份 header fields 表
4. 服务端推送

## HTTP request 和 response 协议组成

![image](https://camo.githubusercontent.com/865183d09938ef9eb0dbc9fcd0bde52beeb63758/68747470733a2f2f75706c6f61642d696d616765732e6a69616e7368752e696f2f75706c6f61645f696d616765732f323936343434362d666466623161386663653864653934362e706e673f696d6167654d6f6772322f6175746f2d6f7269656e742f)

![image](https://camo.githubusercontent.com/06f38586e2140c86f92b8073fd1c23befad3c659/68747470733a2f2f75706c6f61642d696d616765732e6a69616e7368752e696f2f75706c6f61645f696d616765732f323936343434362d316334636162343666323730643865652e6a70673f696d6167654d6f6772322f6175746f2d6f7269656e742f)

## HTTP 缓存

![image](https://github.com/guoxiaoxing/android-open-framwork-analysis/raw/master/art/okhttp/http_cache_structure.png)

![image-20190604215327120](/Users/lixiongwen/Library/Application Support/typora-user-images/image-20190604215327120.png)

## HTTPS SSL 握手过程

假设现在有客户端 A 和服务器 B ：

- 1、首先，客户端 A 访问服务器 B ，比如我们用浏览器打开一个网页 [www.baidu.com](http://www.baidu.com/) ，这时，浏览器就是客户端 A ，百度的服务器就是服务器 B 了。这时候客户端 A 会生成一个随机数1，把随机数1 、自己支持的 SSL 版本号以及加密算法等这些信息告诉服务器 B 。
- 2、服务器 B 知道这些信息后，然后确认一下双方的加密算法，然后服务端也生成一个随机数 B ，并将随机数 B 和 CA 颁发给自己的证书一同返回给客户端 A 。
- 3、客户端 A 得到 CA 证书后，会去校验该 CA 证书的有效性，校验方法在上面已经说过了。校验通过后，客户端生成一个随机数3 ，然后用证书中的公钥加密随机数3 并传输给服务端 B 。
- 4、服务端 B 得到加密后的随机数3，然后利用私钥进行解密，得到真正的随机数3。
- 5、最后，客户端 A 和服务端 B 都有随机数1、随机数2、随机数3，然后双方利用这三个随机数生成一个对话密钥。之后传输内容就是利用对话密钥来进行加解密了。这时就是利用了对称加密，一般用的都是 AES 算法。
- 6、客户端 A 通知服务端 B ，指明后面的通讯用对话密钥来完成，同时通知服务器 B 客户端 A 的握手过程结束。
- 7、服务端 B 通知客户端 A，指明后面的通讯用对话密钥来完成，同时通知客户端 A 服务器 B 的握手过程结束。
- 8、SSL 的握手部分结束，SSL 安全通道的数据通讯开始，客户端 A 和服务器 B 开始使用相同的对话密钥进行数据通讯。

简化如下：

- 1、客户端和服务端建立 SSL 握手，客户端通过 CA 证书来确认服务端的身份；
- 2、互相传递三个随机数，之后通过这随机数来生成一个密钥；
- 3、互相确认密钥，然后握手结束；
- 4、数据通讯开始，都使用同一个对话密钥来加解密；

可以发现，在 HTTPS 加密原理的过程中把对称加密和非对称加密都利用了起来。即利用了非对称加密安全性高的特点，又利用了对称加密速度快，效率高的好处。

## 中间人攻击

- 1、嗅探： 嗅探或数据包嗅探是一种用于捕获流进和流出系统/网络的数据包的技术。网络中的数据包嗅探就好像电话中的监听。
- 2、数据包注入： 在这种技术中，攻击者会将恶意数据包注入常规数据中。这样用户便不会注意到文件/恶意软件，因为它们是合法通讯流的一部分。
- 3、会话劫持： 在你登录进你的银行账户和退出登录这一段期间便称为一个会话。这些会话通常都是黑客的攻击目标，因为它们包含潜在的重要信息。在大多数案例中，黑客会潜伏在会话中，并最终控制它。
- 4、SSL剥离： 在SSL剥离攻击中，攻击者使SSL/TLS连接剥落，随之协议便从安全的HTTPS变成了不安全的HTTP。

## HTTP 响应码

1**	信息，服务器收到请求，需要请求者继续执行操作

2**	成功，操作被成功接收并处理

3**	重定向，需要进一步的操作以完成请求

4**	客户端错误，请求包含语法错误或无法完成请求

5**	服务器错误，服务器在处理请求的过程中发生了错误